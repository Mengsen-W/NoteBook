# Unix 环境编程

## 1. 文件系统
---
---
### 1. 文件IO
1. 文件的操作依赖于文件描述符，在Unix中文件描述符是在一个文件的唯一标识。
2. 内核维护了一个打开文件表，存在在打开文件描述符和文件表项，显示的保存在 /dev/fd中。
3. 一个进程维护打开文件表，表项包括文件描述符和指向文件表项的指针，文件表项的指针由系统的打开文件表项维护。
4. 在一个Unix中，文件的操作包括以下几种
```c++
open()/openat() // 打开操作
                // 可以和creat()函数合并为一个原子操作
creat() // 创建文件
close() // 关闭文件，小心内存泄漏
read()/write()  // 读写操作
dup()/dup2()    // 复制文件描述符
sync()/fsync()/fdatasync()  // 磁盘存储方式
                            //是否经过缓冲区
                            //是否修改权限
fcntl() // 改变打开文件的属性
ioctl() //IO操作的工具箱
```
---
### 2. 目录
1. Unix 中文件类型分为
    - 普通文件：内容是数据
    - 目录文件：包含其他文件名字及指向浙西文件的指针。对一个目录文件具有读权限的任一进程都可以读该目录的内容，但只有内核可以直接写目录文件。进程必须使用特定的函数才能更改目录。
    - 字符特殊文件：这种类型的文件提供对设备不带缓冲的访问，每次访问长度可变。系统中的所有设备要么是字符特殊文件，要么是块特殊文件。
    - 块特殊文件：这种类型的文件提供对设备（如磁盘）带缓冲的访问，每次访问以固定长度为单位进行。
    - FIFO：用于进程建通讯的文件，也称命名管道
    - 套接字文件：用于进程见的网络通讯
    - 符号链接：指向另一个文件
2. 文件的逻辑系统：每一个磁盘分区分为
    - 自举块：用于引导
    - 超级块：在超级块中保存着文件系统的属性信息、磁盘布局和资源使用情况等信息。是对整个磁盘全局的概括
    - 一些柱面：保存用户或内核产生的数据
        - 超级块副本
        - 配置信息
        - i结点图维护所有i结点的信息，包括不限于i节点的类型
        - 块位图：维护数据块的信息
        - 
